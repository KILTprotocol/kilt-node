include:
  - local: '.gitlab/check.yml'
  - local: '.gitlab/test.yml'
  - local: '.gitlab/build.yml'
  - local: '.gitlab/release.yml'

variables:
  CARGO_HOME: $CI_PROJECT_DIR/.cargo
  CARGO_TARGET_DIR: $CI_PROJECT_DIR/target
  DOCKER_HUB_PARACHAIN: "kiltprotocol/kilt-node"
  DOCKER_HUB_STANDALONE: "kiltprotocol/standalone-node"
  DOCKER_HUB_DIP_PROVIDER_TEMPLATE: "kiltprotocol/dip-provider-node-template"
  DOCKER_HUB_DIP_CONSUMER_TEMPLATE: "kiltprotocol/dip-consumer-node-template"
  TRY_RUNTIME_CLI_VERSION_TAG: v0.7.0

cache:
  key: ${CI_COMMIT_REF_SLUG}-rust
  paths:
    - target
    - .cargo/bin/
    - .cargo/registry/index/
    - .cargo/registry/cache/
    - .cargo/git/db/

workflow:
  auto_cancel:
    on_new_commit: interruptible

stages:
  - test
  - build
  - release
